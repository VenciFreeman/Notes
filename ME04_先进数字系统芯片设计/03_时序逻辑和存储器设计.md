# 时序逻辑和存储器设计

[TOC]

## 基本时序单元

### 基础

#### 时序定义

- 当前输出与当前输入以及当前状态有关，是时序逻辑 
  - 区分当前、之前与将来
  - 用时钟进行区分
- 当前输出只与当前输入有关，是组合逻辑
  - 时钟信号与控制信号进行与非，是组合逻辑

#### 基本单元

- 时间轴标定时间
- 存储单元记忆当前状态/之前输出
  - 动态存储单元：电容
    - 充放电
  - 静态存储单元：(偶数级)反向器环
    - 0与1在反向器环中反复转换，不会丢失
    - 奇数级反向器环会成为振荡器

#### 时钟作用

- 时钟同步电路的使用，进行时间的标定
  - 当前大部分设计都是同步逻辑

### 示例

#### RS触发器

<img src=" ../fig/ME04/ME04_chapter03_fig01.jpg" style="zoom:67%;" />

- 和级联反向器一样具有强制将输出设为0 (reset)或1 (set)的能力
  - 或非门组成的RS触发器，两个电路等效
  - R，S均为零时，或非门相当于反向器

<img src=" ../fig/ME04/ME04_chapter03_fig02.jpg" style="zoom:67%;" />

### CMOS逻辑中的基本时序单元

> CMOS中使用的触发器没有数电中那么多，例如T触发器，JK触发器都不使用

<img src=" ../fig/ME04/ME04_chapter03_fig03.jpg" style="zoom:50%;" />

#### DL (D-latch)

> D锁存器

- 电平采样
  - 透明锁存
  - D锁存

##### D Latch的结构

<img src=" ../fig/ME04/ME04_chapter03_fig04.jpg" style="zoom:67%;" />

- 下面的门是三态反馈门
  - 输入时该门是高阻态
  - 断开传输门，该门导通形成反向器环
  - 静态
  - 逆行风险
- 静态闩锁现在必不可少

##### D Latch的晶体管实现

<img src=" ../fig/ME04/ME04_chapter03_fig05.jpg" style="zoom:67%;" />

#### DFF (D-flip-flop)

> D主从触发器

- 边沿采样
  - 主从触发器
  - D触发器
  - D寄存器
- 触发器构建为成对的背对背锁存

##### 主从触发器 (两级DL)

<img src=" ../fig/ME04/ME04_chapter03_fig06.jpg" style="zoom:60%;" />

#### DFF with Reset

- 启用时将力输出设置为高
- 触发器具有异步置位和复位功能

<img src=" ../fig/ME04/ME04_chapter03_fig07.jpg" style="zoom:60%;" />

## 时序收敛

### 时钟重要性

- FO4中的周期时间
- 每一代时钟周期越来越短

<img src=" ../fig/ME04/ME04_chapter03_fig08.jpg" style="zoom:60%;" />

### 时钟的历史

- 早期：单一时钟或多相位时钟，定制化选择时钟
- 晶体管数目达到百万以上：全同步逻辑
- 频率达到100 MHz以上：考虑Skew问题
- 晶体管数目达到千万以上：考虑插入时钟树
- 晶体管上亿/频率GHz以上：考虑多时钟域

### 术语定义

> - 时钟事件周围有一个时序“窗口”，在此期间输入必须保持稳定且不变才能被识别
>
> - 由于数据到达时间、时钟沿、建立保持时间都是一个区间，随PVT变化，时序问题变得复杂

<img src=" ../fig/ME04/ME04_chapter03_fig09.jpg" style="zoom:60%;" />

#### 时钟 (clock)

- 周期性事件，导致存储元件的状态改变
- 上升沿，下降沿，高电平，低电平

#### 建立时间 (tsu, setup time)

- 时钟事件发生之前输入必须稳定的最短时间

#### 保持时间 (th, hold time)

- 时钟事件之后输入必须保持稳定的最短时间

### 时序违例

#### 示例

##### 建立时间违例

$$
t_{pd}\le T_c-(t_{setup}+t_{pcg})
$$

<img src=" ../fig/ME04/ME04_chapter03_fig10.jpg" style="zoom:60%;" />

##### 保持时间违例

> 问题：竞赛条件可能导致F1的快速新令牌在F2上的旧令牌的最短保留时间之前到达F2

$$
t_{cd}\ge t_{hold}-t_{ccq}
$$

<img src=" ../fig/ME04/ME04_chapter03_fig11.jpg" style="zoom:70%;" />

#### 相关设计方法和手段

- **动态延迟评估**：仿真，激发最长通路；是比较准确的观察延迟方法，但难以实现对所有通路的观测
- **静态延迟评估**：STA工具
- **版图参数提取及后仿真** (Post sim)：提取布局布线后版图的电阻、电容寄生参数，进行更加精确的延迟计算
- **逻辑综合**：设置timing constraints，根据设计者对电路结构的了解，为延迟设定容限

#### 静态时序分析

- 时序电路中的主要延迟问题
  - 门延迟 (gate delay)是由于门转换引起的
  - 线延迟(wire delays)是由于信号沿电线传播造成的
  - 时钟偏斜(clock skew)是由于顺序元素激活的时间不同造成的
- 需要快速估算时序电路时序
  - 执行静态时序分析 (STA)
  - 假设时钟偏差可以忽略不计，请延迟到时钟网络综合之后再进行

<img src=" ../fig/ME04/ME04_chapter03_fig12.jpg" style="zoom:60%;" />

#### 时序违例小结

- 与时钟和电路延迟相关问题
- 由于布线影响延迟，所以严重依赖布线情况
- 目前的EDA工具可以通过计算评估延迟，但是近似范围，并非精确值 (可能过于保守，也可能过于乐观)
- 时序问题是在逻辑门级进行检查，而延迟计算需要物理设计 (版图)参数，效果是时序不收敛
- 解决
  - 很好地预评价通路延迟，在逻辑综合阶段留有余地
  - 很好地进行版图规划
  - 很好地利用布线资源

### 时钟偏斜/抖动

- 时钟并非总是准时到达
  - 偏斜：不同时钟元素的时钟在不同时间到达
  - 抖动：一个时钟在每个周期的不同时间到达
    - 时钟源的不稳定导致时钟沿的不确定性
- 时钟性能取决于配电网（以后）

<img src=" ../fig/ME04/ME04_chapter03_fig13.jpg" style="zoom:80%;" />

#### 来自哪里

- 时钟产生
- 设备变化
- 互连变化
- 环境
- 电容耦合

#### 影响

##### 时序问题更为复杂

- 假设零时钟偏移
- 时钟确实有不确定的到达时间
  - 减少最大传播延迟
  - 增加最小污染延迟
  - 减少时间借用
- 如果违反设置时间，需要降低时钟速度
- 如果违反保持时间，芯片将在任何速度时发生故障
- 工作芯片最为重要
  - 没有工具可以分析时钟偏斜

<img src=" ../fig/ME04/ME04_chapter03_fig14.jpg" style="zoom:60%;" />

- 时钟网络的不确定性随处可见
- 影响所传送时钟的偏斜，抖动和占空比

<img src=" ../fig/ME04/ME04_chapter03_fig15.jpg" style="zoom:80%;" />
$$
t_{pd}\le T_c-(t_{setup}+t_{pcq}+t_{skew})\\
t_{cd}\ge t_{hold}-t_{ccg}+t_{skew}
$$
<img src=" ../fig/ME04/ME04_chapter03_fig16.jpg" style="zoom:80%;" />

#### 如何解决

<img src=" ../fig/ME04/ME04_chapter03_fig17.jpg" style="zoom:80%;" />

##### 时钟网络综合示例

<img src=" ../fig/ME04/ME04_chapter03_fig18.jpg" style="zoom:60%;" />

##### 时钟树

<img src=" ../fig/ME04/ME04_chapter03_fig19.jpg" style="zoom:80%;" />

<img src=" ../fig/ME04/ME04_chapter03_fig20.jpg" style="zoom:80%;" />

- 消除了由于POD引起的偏斜差异
  - 但消耗大量电能，例如网格
  - 0.18μm的IBM Power 4在时钟和锁存器中消耗70％的功率

<img src=" ../fig/ME04/ME04_chapter03_fig21.jpg" style="zoom:80%;" />

### 对于时钟话题和形象描述

- 时序的数据路径就像有交通信号灯的街道
  - 沿着街道行驶的汽车 (数据)
    - 有些车快，有些车正常行驶，有些慢
    - 主要原则：不能让两辆汽车相互碰撞
  - 当汽车 (数据)遇到信号灯 (触发器或锁存器)
    - 如果指示灯为绿色，则通过
    - 如果指示灯为红色，则等待
- 时钟系统就像信号灯的总控制者
  - 所有信号灯同时变红/变绿
    - 一些系统中信号灯短暂变绿 (触发器)
    - 在其他系统中信号灯有一半时间为绿 (锁存器)
- 信号灯的目的是让过快的车变慢
- 信号灯 (触发器或锁存器)可以通过两种方式使主要规则失败
  - 最大路径：过慢的车可能到达不了下一个街区
    - 当信号等变红时还未到达路口
  - 最小路径：过快的车可能一次穿过了多个街区
    - 当信号灯变红时，路口已清空
  - 故障通常是交通信号灯的时间安排不理想引起
    - 交通信号灯之间的差异 (偏斜)或局部变化 (抖动)
  - 解决这些故障
    - 修复最大路径：降低主控制器的速度
    - 最小路径不可行：重建街道 (或灯光控制线)
      - 3个月的制造时间和100万美元的掩模成本
  - 真的需要信号灯吗
    - 不需要，如果您可以保证所有汽车的行驶速度相同
    - 管道传输可确保所有数据路径具有相同的延迟
  - 所有的灯都需要同时开关吗
    - 不需要，长街区可能会从不同的光时序中受益
    - 芯片上故意的时钟偏移有助于解决时序问题
  - 真的需要主控制器吗
    - 不需要，如果汽车间可以进行协商
    - 数据项之间的异步电路握手

## 存储器概述

### 存储器在芯片中的地位

#### 市场

**2013年集成电路市场统计**

|   市场总量   | ＞3000亿美元 |
| :----------: | :----------: |
|    存储器    |  670亿美元   |
|    处理器    |  590亿美元   |
| 其他数字电路 |  860亿美元   |
|   模拟电路   |  400亿美元   |
|   光电器件   |  280亿美元   |

- 近几年， 存储器市场主导整个集成电路市场的增长率， 年产值超过千亿美元

#### 芯片

<img src=" ../fig/ME04/ME04_chapter03_fig22.jpg" style="zoom:80%;" />

### 存储器简介

- 数字系统功能
  - 信息传输，处理，存储
- 存储功能
  - 程序，数据
- 不同的特性要求
  - 密度 (常规程序>数据)
  - 速度或延迟 (常规数据>程序)
  - 功耗 (一般为总功率的30％到50％)
  - 挥发性/非挥发性

### 分类

- 性能要求
  - 高密度，高速，低功耗，非易失性
    - 不可能
- 平衡
  - 高密度，低速 (DRAM)
  - 非易失，低速 (闪存，EEPROM)
  - 低密度，高速 (SRAM)
- 内存 (SRAM)层次结构
  - 注册文件，缓存，主存储器
- 被很多人忽略的
  - 可靠性，良率

<img src=" ../fig/ME04/ME04_chapter03_fig23.jpg" style="zoom:80%;" />

#### 特性比较

| 存储形式 |     SRAM     |  DRAM  |    Flash    |
| :------: | :----------: | :----: | :---------: |
|   速度   |     很快     |   快   |    很慢     |
|   密度   |      低      |   高   |    很高     |
|  耐久性  |     较好     |  较好  |    较差     |
|   功率   |      低      |   高   |    很低     |
|   刷新   |      否      |   是   |     否      |
|   保持   |    易失性    | 易失性 |  非易失性   |
| 可拓展性 |      好      |   坏   |     好      |
|   机制   | 双稳态锁存器 |  电容  | FN隧穿，HCI |

### 在整体结构中

#### 通常架构

##### 单端

<img src=" ../fig/ME04/ME04_chapter03_fig24.jpg" style="zoom:60%;" />
$$
M:8,16,32~bits\\N:\bar{G}
$$

- 直观架构
- 一次只能选一行，选择信号太多

##### 地址编码

<img src=" ../fig/ME04/ME04_chapter03_fig25.jpg" style="zoom:60%;" />

- 地址编码减少了选择信号的数量
- 问题：`长宽比` (aspect ratio)
  - 横向32位/纵向2^32^行
- 接近方形的芯片应力更好，且浪费晶圆更小

##### 分行列

<img src=" ../fig/ME04/ME04_chapter03_fig26.jpg" style="zoom:100%;" />

- 分为行地址和列地址，更好的宽长比

<img src=" ../fig/ME04/ME04_chapter03_fig27.jpg" style="zoom:100%;" />

- 行地址通过行译码器选择
- 再通过列译码器选择
- 控制逻辑在读取时对数据进行放大
  - 过远的信号到达输入输出时会很微弱

##### 分块

<img src=" ../fig/ME04/ME04_chapter03_fig28.jpg" style="zoom:100%;" />

#### 总结

- 顺序访问
  - 解码器机制不同
- 多端口访问
  - 多地址
  - 多输入/输出
- 嵌入式内存
  - SRAM或闪存
    - 寄存器堆用SRAM制作
  - 由代工厂提供：内存编译器
  - 许多小的内存/DFF作为寄存器文件：不可以！
    - 少使用细碎的小存储器
  - 对于某些特殊情况，我们需要手动设计

## 存储器：SRAM

### SRAM单元

<img src=" ../fig/ME04/ME04_chapter03_fig29.jpg" style="zoom:100%;" />

- 反向器环：最简单的静态存储单元
- 加一个开关：基本输入输出
- 加两个开关：差分输入输出
- bit line：位线
- word line：控制信号，字线
- 0会读得很好，但1会有损耗，需要用其他方法解决

#### 6晶体管SRAM单元

- 无待机能耗
- 两条互补位线改善噪声容限
- 所有晶体管尺寸越小越好
- $WL=1$时导通

<img src=" ../fig/ME04/ME04_chapter03_fig30.jpg" style="zoom:100%;" />

#### 读分析 (读"1"）

- $Q=1$ (存储)
  - 要读取，$BL$和$\overline{BL}$预充电至V~DD~
  - 读取周期从声明WL开始。
  - 仔细选择M5/M1的尺寸，以避免read upset (将0写入$Q$)
- $\overline{BL}$通过M5和M1下拉
- M1尺寸与M5相关
- $WL$上升时，$\bar{Q}$可以被M5上拉到预充电的$\overline{BL}$ (V~DD~)
- 使$W_{M1}>W_{M5}$以安全地下拉$\bar{Q}$和$\overline{BL}$
- 调整M1和M5的尺寸以减小电压纹波$\Delta V$
  - 如果$\Delta V>0.4V$，则可以通过上拉$\bar{Q}$来翻转存储的Q =1

##### 用于读的CMOS SRAM尺寸

<img src=" ../fig/ME04/ME04_chapter03_fig31.jpg" style="zoom:80%;" />
$$
CR=\frac{W_1/L_1}{W_5/L_5}
$$

- 首选解决方案
  - M5使用最小尺寸
  - 加大M1尺寸

#### 写分析 (写"0"）

<img src=" ../fig/ME04/ME04_chapter03_fig32.jpg" style="zoom:80%;" />

- 假设存储了“1” ($Q=1$)
  - 要写“0” ($Q=0$)
  - 必须通过M6释放Q
  - 但在开始时，M4也会尝试将Q上拉
- 通过设置$BL=0$ ($\overline{BL}=1$)将$Q=0$写入单元
- 写“0”的两种方法
  - 通过M5上拉$\bar{Q}$ (调整读取大小会限制此选项)
  - 通过M6下拉$Q$ (具有M4和M6尺寸，因为M4将Q向上拉)
    - 将Q拉至$V_{Tn}=0.4V$以下，以使关断的M1和M2导通

##### 用于写的CMOS SRAM尺寸

<img src=" ../fig/ME04/ME04_chapter03_fig32.jpg" style="zoom:100%;" />
$$
PR=\frac{W_4/L_4}{W_6/L_6}
$$

- 首选解决方案 (这样$PR<1.8$)
  - M6使用最小尺寸
  - 加大M4尺寸

<img src=" ../fig/ME04/ME04_chapter03_fig33.jpg" style="zoom:80%;" />

#### 版图

<img src=" ../fig/ME04/ME04_chapter03_fig34.jpg" style="zoom:100%;" />

#### 单元尺寸

- 保持单元大小最小对于大型缓存至关重要

- 最小尺寸的下拉FET (M1和M3)

  - 需要最小宽度并且比最小通道长度的传输晶体管 (M5和M6)更长，以确保适当的CR
  - 但是调整传输晶体管的大小会增加字线上的电容负载，并限制位线上的放电电流，这两者都会对读取周期的速度产生不利影响

- 最小宽度和长度的通过晶体管

  - 增大下拉晶体管的宽度 (M1和M3)

  - 减少字线上的负载并增加单元中的存储电容

    > 两者都很好，但单元大小可能会稍大

#### 静态噪声容限

<img src=" ../fig/ME04/ME04_chapter03_fig35.jpg" style="zoom:60%;" />

```
SNM(静态噪声容限) = 静态噪声源V_n最大值，非翻转单元状态
```

- 电池状态可能会受到干扰
- DC
  - 布局图案偏移
  - 工艺不匹配
    - 植入不均匀
    - 门图案尺寸错误
- AC
  - α粒子
  - 串扰
  - 电源电压纹波
  - 热噪声

### 阻性负载4晶体管SRAM单元

<img src=" ../fig/ME04/ME04_chapter03_fig36.jpg" style="zoom:80%;" />

- 4个晶体管，简化了接线
  - 可以减少1/3的面积
- 使用高阻性负载以降低静态功率
- 缓慢上拉并不是问题，因为位线已预充电

### 可比逻辑的静态功耗

<img src=" ../fig/ME04/ME04_chapter03_fig37.jpg" style="zoom:60%;" />
$$
I_{low}↓=\frac{V_{DD}-V_{OL}}{R_L↑},~P{low}↓=V_{DD}I_{low}\\
V_{in}=V_{DD}\rightarrow V_{out}=V_{OL}>0
$$

- 但是大的RL会导致上拉慢
- 幸运的是SRAM不需要“上拉”

### 案例：多读/写端口单元

<img src=" ../fig/ME04/ME04_chapter03_fig38.jpg" style="zoom:80%;" />

- 考虑单端口SRAM
  - 每个周期读一次或写一次
- 寄存器文件需要多端口SRAM
- 右侧：寄存器堆使用的存储器，可以进行每个周期四读三写
- 举例
   - 多周期MIPS必须读取两个源或在某些周期上写入结果
   - 流水线式MIPS必须在每个周期读取两个源并写入第三个结果
   - 超标量MIPS必须在每个周期读取和写入许多源和结果

### 内存编译器

- 在ASIC流程中，存储器编译器用于为设计中的SRAM块生成布局
  - 现代SoC中通常有数百个内存实例
  - 内存生成器还可以生成内置的自测（BIST）逻辑，以加快制造测试，并提供冗余的行/列以提高良率
- 可以通过字数，每个字的位数，所需的宽高比，子存储区数，列混合程度等参数化编译器。
  - 设计参数和生成算法的面积，延迟和能耗的复杂函数
  - 值得尝试设计空间
- 通常在ASIC库中只有一个读或写端口SRAM和一个读和写SRAM生成器
- 由于外围电路，BIST和冗余，编译后的SRAM阵列通常具有较高的开销。 小型存储器通常由标准单元流中的锁存器和/或触发器构建

## 存储器：DRAM

### 单晶体管DRAM单元

- 与CMOS不兼容，无法做进CMOS逻辑
- 寄生效应：电荷共享
  - 每读一次都必须重新写一次 ($\Delta V$变化，0会变化)
- 漏电
  - 需要定期 (拿出10%的时间，例如每10ms用1ms刷新。并不是集中，而是分块)刷新单元
  - 刷新过程：逐行重新读再重新写
  - 或者使用大电容

<img src=" ../fig/ME04/ME04_chapter03_fig39.jpg" style="zoom:80%;" />
$$
\Delta V=V_{BL}-V_{PRE}=(V_{BIT-V_{PRE}})\frac{C_S}{C_S+C_{BL}}
$$

- 写：$C_S$已充电/已放电
- 读：电荷在$BL$和$C_S$之间重新分配 (小电压摆幅~250 mV)

#### 早期制造

<img src=" ../fig/ME04/ME04_chapter03_fig40.jpg" style="zoom:80%;" />

- 使用多晶硅扩散电容 (价格昂贵)

#### 目前工艺

- 深槽电容
  - 使用深槽的侧壁电容

### DRAM单元

- 1T DRAM由于电荷重新分配读出，每个位线都需要一个读出放大器
- 与SRAM单元相比，DRAM存储单元为单端。
- 1T DRAM单元的读取具有破坏性； 读取和刷新操作对于正确操作是必需的
- 与3T电池不同，1T电池需要存在额外的电容，该电容必须明确包含在设计中
- 向DRAM单元写入“ 1”时，会丢失阈值电压
  - 可以通过将字线引导至高于V~DD~的值来避免这种电荷损失

#### 具有虚拟单元的开放位线架构

<img src=" ../fig/ME04/ME04_chapter03_fig41.jpg" style="zoom:80%;" />

- DRAM的线很长
- 每行的两侧做两个虚拟单元
  - 电荷是0与1的中间值

## 存储器：不挥发存储器

### ROM单元

### 分类

- 完全不能改写的：ROM
- 可改写的

<img src=" ../fig/ME04/ME04_chapter03_fig42.jpg" style="zoom:80%;" />

### MOS NOR ROM

<img src=" ../fig/ME04/ME04_chapter03_fig43.jpg" style="zoom:80%;" />

- 没有晶体管的也是行

#### 版图

<img src=" ../fig/ME04/ME04_chapter03_fig44.jpg" style="zoom:80%;" />

### EEPROM单元

- 机理类似
- 采用浮栅工艺

<img src=" ../fig/ME04/ME04_chapter03_fig45.jpg" style="zoom:60%;" />

#### 非易失性存储器：浮栅晶体管

<img src=" ../fig/ME04/ME04_chapter03_fig46.jpg" style="zoom:80%;" />

##### “可控阈值”晶体管

<img src=" ../fig/ME04/ME04_chapter03_fig47.jpg" style="zoom:80%;" />

<img src=" ../fig/ME04/ME04_chapter03_fig48.jpg" style="zoom:80%;" />

#### 特性

- Write -> Erase/Program:
  - Erase: all chip or page
  - Program: byte
- Read speed: ns
- Erase/Program time: us~s
  - Charge pump
- Endurance: E/P cycle: 1M
- Data retention: 10 years



- 写入 → 擦除/编程
  - 擦除：所有芯片或页面
  - 程序：字节
- 读取速度：ns
- 擦除/编程时间：us-s
     - 电荷泵
   - 耐久性：E/P周期：1M
   - 数据保留时间：10年

### 新型单元

- FRAM
- PCRAM
- RRAM
- SpinRAM
- ... ...

<img src=" ../fig/ME04/ME04_chapter03_fig49.jpg" style="zoom:80%;" />

#### 各类存储器的比较

<img src=" ../fig/ME04/ME04_chapter03_fig50.jpg" style="zoom:80%;" />

## 存储器：外围电路

### SRAM外围

<img src=" ../fig/ME04/ME04_chapter03_fig51.jpg" style="zoom:80%;" />

- 控制功耗的关键
  - 众多长线带来功耗
  - 灵敏放大带来功耗

### 解码器

**2^M^复杂逻辑门的集合，有条不紊地组织**

- (N)AND解码器

$$
WL_0=A_0A_1A_2A_3A_4A_5A_6A_7A_8A_9\\
WL_511=\bar{A}_0A_1A_2A_3A_4A_5A_6A_7A_8A_9
$$

- NOR解码器

$$
WL_0=\overline{A_0+A_1+A_2+A_3+A_4+A_5+A_6+A_7+A_8+A_9}\\
WL_511=\overline{A_0+\bar{A}_1+\bar{A}_2+\bar{A}_3+\bar{A}_4+\bar{A}_5+\bar{A}_6+\bar{A}_7+\bar{A}_8+\bar{A}_9}
$$

**多级实施可提高性能**

<img src=" ../fig/ME04/ME04_chapter03_fig52.jpg" style="zoom:80%;" />

#### 动态解码器

<img src=" ../fig/ME04/ME04_chapter03_fig53.jpg" style="zoom:80%;" />

#### 4输入通过晶体管的列解码器

<img src=" ../fig/ME04/ME04_chapter03_fig54.jpg" style="zoom:80%;" />

- 优点
  - 速度快 (T~pd~不会增加总的内存访问时间)
  - 信号路径中只有一个额外的晶体管
- 缺点：晶体管数量多

### 感测放大器

<img src=" ../fig/ME04/ME04_chapter03_fig55.jpg" style="zoom:80%;" />

- 位线帽对大型阵列有效
  - 如果每个单元贡献2fF
    - 用于256单元，512fF加导线帽
  - 下拉电阻约为15K
  - RC = 7.5ns (假设$DV = V_{DD}$)
- 无法轻松更改R，$C或V_{DD}$，但可以更改$\Delta V$，即最小感测电压
  - 可以可靠地检测到小于50mV的$\Delta V$

$$
\tau=\frac{RC\Delta V}{V_{DD}}\\
R:Xtor电阻\\
\frac{R}{V_{DD}}:单元电流
$$

$$
t_p=\frac{C\times\Delta V}{I_{av}}
$$

- $\Delta V$越小越好
  - 小的位线摆幅 → 降低功率和延迟

<img src=" ../fig/ME04/ME04_chapter03_fig56.jpg" style="zoom:80%;" />

#### 感测放大器操作曲线

<img src=" ../fig/ME04/ME04_chapter03_fig57.jpg" style="zoom:80%;" />

#### 预充电电路+电池+感测放大器

<img src=" ../fig/ME04/ME04_chapter03_fig58.jpg" style="zoom:80%;" />

#### 差分感测放大器

<img src=" ../fig/ME04/ME04_chapter03_fig59.jpg" style="zoom:80%;" />

#### 从单元中读“1”

<img src=" ../fig/ME04/ME04_chapter03_fig60.jpg" style="zoom:80%;" />